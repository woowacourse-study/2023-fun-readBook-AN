# 3장 타입과 추상화



## 추상화를 통한 복잡성 극복

추상화의 목적은 현실의 불필요한 부분을 도려내가면서(무시함으로써) 현실에 존재하는 복잡성을 극복하는 것이다.

책에서 예시로 든 해리 벡의 지하철 노선도 역시 불필요한 지형 정보를 제거하고 승객들의 목적에 맞게 현실을 단순화했다.

(승객들에겐 지형 정보나 역의 위치가 아닌 역과 역 사이의 연결 관계가 중요했던 것이다.)



인상 깊었던 부분은 아래와 같다.

*어떤 추상화도 의도된 목적이 아닌 다른 목적으로 사용된다면 오도될 수 있다. 추상화의 수준, 이익, 가치는 **목적**에 의존적이다.*

*리처드 파인만의 말처럼 "현상은 복잡하다. 법칙은 단순하다. 버릴 게 무엇인지 알아내라"*



추상화 과정 (두 차원)

* 첫 번째 차원: 구체적인 사물들 간의 공통점은 취하고 차이점은 버리는 일반화를 통해 단순하게 만드는 것이다.
* 두 번째 차원: 중요한 부분을 강조하기 위해 불필요한 세부 사항을 제거함으로써 단순하게 만드는 것이다.



모든 경우에 추상화의 목적은 복잡성을 이해하기 쉬운 수준으로 단순화하는 것이라는 점을 기억해라.





## 객체지향과 추상화

<br>

#### 그룹으로 나누어 단순화하기

엘리스의 이야기에서 정원에 수많은 객체들이 등장한다.

엘리스는 그들의 다른 차이점들을 무시하고 '트럼프'라는 공통적인 외형과 행동 방식으로 묶었다.

그리하여 정원에는 '트럼프'와 '토끼' 두 그룹만 남게 되었다.

<br><br>

#### 개념

**개념(concept)**

수 많은 객체를 개별적으로 인지하는 것은 어려우므로 , 인지할 가짓수를 줄이기 위해 객체를 그룹 단위로 묶을 공통적 특성을 말한다.

**분류(classification)**

개념을 이용하여 개념을 여러 그룹으로 나누는 일. 결과적으로 개념은 공통점으로 객체를 분류할 수 있는 일종의 체라고 할 수 있다.

**인스턴스(instance)**

객체에 어떤 개념 적용이 가능해져 해당 개념 그룹의 일원이 될 때 객체를 해당 개념의 인스턴스라고 한다.

<br>

개념이라는 렌즈를 통해 세상을 바라보면 수 많은 객체가 존재하는 복잡한 세상을 몇 개의 개념만으로 단순화할 수 있다.

개념은 객체를 분류할 수 있는 틀을 제공한다.

<br>

<br>

#### 개념의 세 가지 관점

심볼(symbol): 개념을 가리키는 간략한 이름이나 명칭

내연(intension): 개념의 완전한 정의를 나타내며 내연의 의미를 이용해 객체가 개념에 속하는지 여부를 확인할 수 있다.

외연(extention): 개념에 속하는 모든 객체의 집합(set)

<br>

앨리스의 이야기에서 심볼, 내연, 외연을 찾아보자.

먼저 개념을 지칭하는 이름인 '트럼프'가 **심볼**이 된다.

다음으로 '몸이 납작하고 두 손과 두 발이 네모난 몸 모서리에 달려 있다'는 트럼프에 대한 설명이 **내연**이다.

마지막으로 '정원사, 병사, 신하, 왕자와 공주, 하객으로 참석한 왕과 왕비들, 하트 잭, 하트왕과 하트 여왕'이 **외연**이다.

<br>

*처음 안 사실.. class가 classification에서 따온 것이었다니.. 충격..!*

*"객체지향의 세계에서 가장 널리 알려진 유명인사가 클래스(class)라는 사실을 ㄱ마안한다면 분류(classification)라는 개념이 얼마나 중요한지 실감할 수 있을 것이다."*

<br>

<br>

#### 객체를 분류하기 위한 틀

분류는 객체지향의 가장 중요한 개념 중 하나다.

어떤 객체를 어떤 개념으로 분류할지가 객체지향의 품질을 결정한다.

<br>

<br>

## 타입

<br>

#### 타입은 개념이다

개념이라는 단어는 우리의 일상생활에서 폭넓게 사용된다.

그리고 이를 컴퓨터 공학자들은 타입(type)이라고 부른다.

<br>

타입은 개념의 정의와 완전히 동일하다.

타입은 개념과 마찬가지로 심볼, 내연, 외연을 이용해 서술할 수 있으며 타입에 속하는 객체 역시 타입의 인스턴스라고 한다.

<br>

<br>

#### 데이터 타입

컴퓨터의 메모리를 들여다 보면 0과 1의 행렬만이 존재한다.

우리는 메모리의 비트열을 보면서 해당 값이 숫자인지, 문자인지 혹은 주소인지 알 수 없다.

타입 시스템을 적용하면서 모든 데이터를 비트열로 보지 않고 0과 1에 대해 수행 가능한 작업과 불가능한 작업을 구분한다.

<br>

타입은 데이터가 어떻게 사용되느냐에 관한 것이다.

숫자형 데이터는 더하고, 빼고, 곱하고, 나눌 수 있다.

문자열형 데이터는 두 데이터를 연결해 새로운 문자열을 만들거나 문자열의 길이를 알 수 있다.

<br>

타입에 속한 데이터를 메모리에 어떻게 표현하는지는 외부로부터 감춰진다.

개발자는 해당 데이터 타입의 표현 방식을 몰라도 해당 데이터 타입에 적용 가능한 연산자만 알고 있으면 된다.

<br>

<br>

#### 객체와 타입

애플리케이션 내부에 살고 있는 모든 객체의 상태를 모으면 결국 애플리케이션에서 관리해야 하는 전체 데이터를 표현할 수 있다.

그렇다면 객체는 데이터인가? 아니다!

* 객체의 타입을 결정하는 것은 객체의 상태가 아닌 행동이다. 특정 객체들이 동일한 행동을 수행할 수 있다면 해당 객체들은 동일한 타입으로 분류될 수 있다.

* 객체의 내부적인 표현은 외부로부터 철저하게 감춰진다. 객체의 행동을 가장 효과적으로 수행할 수 만 있다면 객체 내부의 상태를 어떤 방식으로 표현하더라도 무방하다. 즉, 객체의 타입은 내부 구현과는 아무런 상관이 없다.

<br>

<br>

#### 행동이 우선이다

앞에서 말했듯 객체들이 동일하게 행동하면 동일한 타입에 속한다.

즉, 동일한 책임을 수행하는 일련의 객체는 동일한 타입에 속한다고 말할 수 있다.

동일한 행동 == 동일한 책임 == 동일한 메시지 수신

<br>

동일한 타입의 객체는 내부에서 데이터나 메시지 처리 방식이 다르더라도 동일한 메시지를 수신하고 이를 처리할 수 있다.

이것은 ***다형성*** 에 의미를 부여한다.

다형성이란 동일한 요청에 대해 서로 다른 방식으로 응답할 수 있는 능력을 뜻한다.

동일한 메시지를 서로 다른 방식으로 처리하기 위해서는 객체들은 동일한 메시지를 수신할 수 있어야 하기 때문에 결과적으로 다형적인 객체들은 동일한 타입(또는 타입 계층)에 속하게 된다.

<br>

데이터의 내부 표현 방식과 무관하게 행동만이 고려 대상이라는 사실은 외부에 데이터를 감춰야 한다는 것을 의미한다.

따라서 훌륭한 객체지향 설계는 외부에 행동만을 제공하고 데이터는 행동 뒤로 감춰야 한다.

이 원칙을 흔히 ***캡슐화*** 라고 한다. 

공용 인터페이스 뒤로 데이터를 캡슐화하라는 오래된 격언은 객체를 행동에 따라 분류하기 위해 지켜야하는 기본적인 원칙이다.

<br>

행동에 따라 객체를 분류하기 위해서는 객체가 외부에 제공해야 하는 행동을 먼저 생각해야 한다.

데이터를 먼저 결정하고 객체의 책임을 결정하는 방법은 유연하지 못한 설계라는 악몽을 초래한다.

이를 위해서는 객체가 외부에 제공해야 하는 책임을 먼저 결정하고 그 책임을 수행하는 데 적합한 데이터를 나중에 결정한 후, 데이터를 책임을 수행하는 데 필요한 외부 인터페이스 뒤로 캡슐화해야 한다.

흔히 **책임-주도 설계(Responsibility-Driven Design)**라고 부르는 객체지향 설계 방법은 데이터를 먼저 생각하는 **데이터-주도 설계(Data-Driven Design)** 방법의 단점을 개선하기 위해 고안됐다.

<br>

<br>

## 타입의 계층

<br>

#### 트럼프 계층

엘리스는 정원사, 병사, 신하, 왕자와 공주.. 이하 중략.. 을 트럼프라고 생각했다.

그렇다면 이들(이하 트럼프 인간)은 정말 트럼프일까?

<br>

트럼프 인간의 외양은 트럼프와 비슷하다. 하지만 타입의 정의를 다시 생각해보자.

객체가 동일한 타입으로 분류되기 위해서는 공통의 행동을 가져야 한다.

<br>

트럼프 인간과 실제 트럼프는 외양은 유사하지만 행동이 완벽하게 동일하지 않다.

트럼프도 트럼프 인간처럼 낲작 엎드리거나 뒤집어질 수는 있지만 걸어다닐 수는 없다.

즉 이들은 실제 트럼프 객체가 할 수 있는 모든 행동뿐만 아니라 추가적으로 걸어다니는 행동을 할 수 있다.

<br>

그럼 이제 외연을 살펴보자. 

트럼프 인간은 인간이다. 따라서 모든 트럼프 인간은 동시에 트럼프다.

그럼 모든 트럼프가 트럼프 인간인가? 그렇지는 않다.

이 관점에서 트럼프는 트럼프 인간을 포괄하는 좀 더 일반적인 개념이다. 

트럼프 인간은 트럼프보다 좀 더 특화된 행동을 하는 특수한 개념이다.

이 두 개념 사이의 관계를 일반화 / 특수화 (generalization / specialization)관계라고 한다.

<br>

<br>

#### 일반화/특수화 관계

일반화/특수화 관계를 결정하는 것은 객체의 상태를 표현하는 데이터가 아니라 행동이다.

더 일반적인 상태를 표현하거나 더 특수한 상태를 표현한다고 일반화/특수화 관계가 성립하는 것은 아니다.

행동의 수: 일반적인 타입 < 특수한 타입 (단 특수한 타입은 일반적인 타입이 할 수 있는 모든 행동을 동일하게 수행해야한다)

외연 집합의 크기: 일반적인 타입 > 특수한 타입

<br>

<br>

#### 슈퍼타입과 서브타입

일반화/특수화 관계에서 일반적인 타입을 **슈퍼타입(Supertype)**, 특수한 타입을 **서브타입(Subtype)**이라고 한다.

어떤 타입이 다른 타입의 서브타입이 되기 위해선 행위적 호환성을 만족시켜야 한다.

그러므로 서브타입은 슈퍼타입을 대체할 수 있어야한다.

트럼프 인간은 트럼프를 대체할 수 있다는 말이다.

<br>

표기 방법

일반적인 슈퍼타입을 상단에, 특수한 서브타입을 하단에 위치시키고 

서브타입에서 슈퍼타입으로 속이 빈 삼각형 화살표로 연결해서 표현한다.

| 트럼프                                    |
| :---------------------------------------- |
| 납작 엎드릴 수 있다<br />뒤집어질 수 있다 |

(위를 가리키는 속이 빈 삼각형)

| 트럼프 인간  |
| ------------ |
| 걸을 수 있다 |

<br>

<br>

## 정적 모델

<br>

#### 타입의 목적

타입을 왜 사용해야할까?

타입을 사용하는 이유는 인간의 인지 능력으로는 시간에 따라 동적으로 변하는 객체의 복잡성을 극복하기가 너무 어렵기 때문이다.

타입은 시간에 따라 동적으로 변하는 앨리스의 상태를 시간과 무관한 정적인 모습으로 다룰 수 있게 해준다.

<br>

<br>

#### 그래서 결국 타입은 추상화다

이런 관점에서 타입은 추상화다.

앨리스에 관해 생각할 때 불필요한 시간이라는 요소와 상태 변화라는 요소를 제거하고 철저하게 정적이 ㄴ관점에서 앨리스의 모습을 묘사하는 것을 가능하게 해준다.

타입을 이용하면 객체의 동적인 특성을 추상화할 수 있다.

결국 타입은 시간에 따른 객체의 상태 변경이라는 복잡성을 단순화할 수 있는 효과적인 방법인 것이다.

<br>

<br>

#### 동적 모델과 정적 모델

뭘 말하고 싶은지 잘 모르겠다

<br>

<br>

#### 클래스

타입을 구현하는 가장 보편적인 방법은 클래스를 이용하는 것이다.

클래스와 타입은 동일한 것이 아니다.

타입은 객체를 분류하기 위해 사용하는 개념이지만 클래스는 단지 타입을 구현할 수 있는 여러 구현 메커니즘 중 하나일 뿐이다.
